% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fct_spectra_curation.R
\name{curate_spectra}
\alias{curate_spectra}
\title{Perform spectra curation}
\usage{
curate_spectra(checked_data, summarized_checks, cut_offs)
}
\arguments{
\item{checked_data}{The return value of the function
\code{\link{check_analyte_quality_criteria}}.}

\item{summarized_checks}{The return value of the function
\code{\link{summarize_spectra_checks}}.}

\item{cut_offs}{The return value of the function
\code{\link{calculate_cut_offs}}.}
}
\value{
The three dataframes given as function arguments joined together, with two additional columns:
  \describe{\item{has_passed_spectra_curation}{\code{TRUE} if the spectrum passed curation, \code{FALSE} otherwise.}
  \item{reason_for_failure}{Describes why the spectrum failed curation, or \code{NA} if it passed.}}
}
\description{
Optimized version: Reduces join operations, uses left_join instead of full_join,
and avoids unnecessary relocation and filtering steps. The output remains the same,
and error handling is preserved. This function performs spectra curation on mass spectrometry data.
All spectra with sum intensities and percentages of passing analytes above
the cut-off values pass spectra curation.
}
\examples{
data("example_data")
checked_data <- check_analyte_quality_criteria(my_data = example_data,
                                               min_ppm_deviation = -20,
                                               max_ppm_deviation = 20,
                                               max_ipq = 0.2,
                                               min_sn = 9,
                                               criteria_to_consider = c("Mass accuracy",
                                                                        "S/N",
                                                                        "IPQ"))
summarized_checks <- summarize_spectra_checks(checked_data = checked_data)
cut_offs <- calculate_cut_offs(summarized_checks = summarized_checks,
                               control_sample_types = "PBS",
                               exclude_sample_types = NULL,
                               group_keyword = "Total",
                               percentile = 97,
                               use_mean_SD = FALSE,
                               SD_factor = NULL,
                               uncalibrated_as_NA = TRUE)
curate_spectra(checked_data = checked_data,
               summarized_checks = summarized_checks,
               cut_offs = cut_offs)
}
